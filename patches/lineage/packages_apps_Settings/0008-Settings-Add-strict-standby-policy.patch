From 38931c0d84032dc7f68594e7233d37fe7986770e Mon Sep 17 00:00:00 2001
From: LibXZR <i@xzr.moe>
Date: Sat, 11 Jun 2022 16:36:06 +0800
Subject: [PATCH] Settings: Add strict standby policy

Change-Id: I8a8b86dba5ff5aa6a31106af5f93a250de76e91f
Signed-off-by: LibXZR <i@xzr.moe>
---
 res/values-zh-rCN/extra_strings.xml | 4 ++++
 res/values-zh-rHK/extra_strings.xml | 4 ++++
 res/values-zh-rTW/extra_strings.xml | 4 ++++
 res/values/extra_strings.xml        | 4 ++++
 res/xml/power_usage_summary.xml     | 6 ++++++
 5 files changed, 22 insertions(+)

diff --git a/res/values-zh-rCN/extra_strings.xml b/res/values-zh-rCN/extra_strings.xml
index d41f3f80839..67f75d2bd93 100644
--- a/res/values-zh-rCN/extra_strings.xml
+++ b/res/values-zh-rCN/extra_strings.xml
@@ -27,4 +27,8 @@
     <string name="status_bar_lyric_options_title">选项</string>
     <string name="disguise_props_for_music_app_title">对音乐应用伪装设备</string>
     <string name="disguise_props_for_music_app_summary">在一些音乐应用中伪装设备以支持状态栏歌词。更改此开关后，您必须重新启动相关应用才能使更改生效。</string>
+
+    <!-- Strict standby -->
+    <string name="laboratory_strict_standby_policy_title">严格的应用待机策略</string>
+    <string name="laboratory_strict_standby_policy_summary">这将对“电池用量”受限的应用启用划卡即停，并对其施加更加严格的应用待机限制。所有限制将在电源连接时也保持执行。</string>
 </resources>
diff --git a/res/values-zh-rHK/extra_strings.xml b/res/values-zh-rHK/extra_strings.xml
index 57aa2066ad7..521b8a2f088 100644
--- a/res/values-zh-rHK/extra_strings.xml
+++ b/res/values-zh-rHK/extra_strings.xml
@@ -27,4 +27,8 @@
     <string name="status_bar_lyric_options_title">選項</string>
     <string name="disguise_props_for_music_app_title">對音樂應用偽裝設備</string>
     <string name="disguise_props_for_music_app_summary">在一些音樂應用中偽裝設備以支持狀態欄歌詞。更改此開關後，您必須重新啟動相關程式才能使更改生效。</string>
+
+    <!-- Strict standby -->
+    <string name="laboratory_strict_standby_policy_title">嚴格的應用程式待機策略</string>
+    <string name="laboratory_strict_standby_policy_summary">這將對「電池用量」受限的應用程式啟用劃卡即停，並對其施加更加嚴格的應用程式待機限制。所有限制將在電源連接時也保持執行。</string>
 </resources>
diff --git a/res/values-zh-rTW/extra_strings.xml b/res/values-zh-rTW/extra_strings.xml
index 40167ad2b8f..346648cffb1 100644
--- a/res/values-zh-rTW/extra_strings.xml
+++ b/res/values-zh-rTW/extra_strings.xml
@@ -27,4 +27,8 @@
     <string name="status_bar_lyric_options_title">選項</string>
     <string name="disguise_props_for_music_app_title">對音樂應用偽裝設備</string>
     <string name="disguise_props_for_music_app_summary">在一些音樂應用中偽裝設備以支持狀態欄歌詞。更改此開關後，您必須重新啟動相關程式才能使更改生效。</string>
+    
+    <!-- Strict standby -->
+    <string name="laboratory_strict_standby_policy_title">嚴格的應用程式待機策略</string>
+    <string name="laboratory_strict_standby_policy_summary">這將對「電池用量」受限的應用程式啟用劃卡即停，並對其施加更加嚴格的應用程式待機限制。所有限制將在電源連接時也保持執行。</string>
 </resources>
diff --git a/res/values/extra_strings.xml b/res/values/extra_strings.xml
index adb25b628e5..7e78bdba20f 100644
--- a/res/values/extra_strings.xml
+++ b/res/values/extra_strings.xml
@@ -27,4 +27,8 @@
     <string name="status_bar_lyric_options_title">Options</string>
     <string name="disguise_props_for_music_app_title">Disguise device for music apps</string>
     <string name="disguise_props_for_music_app_summary">Disguise device in some music applications for support status bar lyric. After changing this toggle, you have to restart applications for the change to take effect.</string>
+    
+    <!-- Strict standby -->
+    <string name="laboratory_strict_standby_policy_title">Strict standby policy</string>
+    <string name="laboratory_strict_standby_policy_summary">When dismissing from recents, this will force stop apps with restricted battery usage and impose stronger restrictions to them. Also, all app standby restrictions will be imposed even when device is charging.</string>
 </resources>
diff --git a/res/xml/power_usage_summary.xml b/res/xml/power_usage_summary.xml
index b791f128598..62502bc7058 100644
--- a/res/xml/power_usage_summary.xml
+++ b/res/xml/power_usage_summary.xml
@@ -74,6 +74,12 @@
         android:summary="@string/fast_charging_summary"
         settings:controller="com.android.settings.fuelgauge.FastChargingPreferenceController"/>
 
+    <lineageos.preference.GlobalSettingSwitchPreference
+        android:key="strict_standby_policy"
+        android:title="@string/laboratory_strict_standby_policy_title"
+        android:summary="@string/laboratory_strict_standby_policy_summary"
+        android:defaultValue="false"/>
+
     <com.android.settingslib.widget.FooterPreference
         android:key="power_usage_footer"
         android:title="@string/battery_footer_summary"
-- 
2.25.1

